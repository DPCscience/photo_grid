[
["index.html", "GRID: Greenfield Image Decoder Why GRID? 0.1 Get Started 0.2 Overview of GRID", " GRID: Greenfield Image Decoder Chunpeng James Chen 2019-07-29 Why GRID? Greenfield imagery decoder (GRID) is a tool allowing you to trace individual crop’s imagery features from a remote sensing image. Performing plot segmentation could be a painful job without a proper tool. GRID comes with several essential imaging processing techniques such as K-means clustering and convolutional operation, accelerating the segmentation process and improving the precision of estimated imagery features. 0.1 Get Started The following installations are required to use GRID: Python 3: Version 3 or later. pip: The Python package installer photo-grid: The Python package GRID can be found on PyPI Launch GRID in Python 3: import photo_grid photo_grid.run() 0.2 Overview of GRID Here you can find the general usage of GRID in 5 steps. Load data GRID only requires an image file to function normally. However, in order to improve the segmentation result, providing a map file could be helpful for GRID to know better about the field layout. If users don’t have suitable image, it’s also possible to learn GRID by choosing “Demo files”. More information about file format can be found here Crop your image Plots extraction Set up center points Finalize plot’s boundary "],
["interface-and-usage.html", "1 Interface and Usage 1.1 Load data 1.2 Crop Images 1.3 Plots extraction", " 1 Interface and Usage 1.1 Load data Map files For the map file, no header or row name needed. It can be a simple tab-delimited text file or comma-separated values (CSV) file. plot_1 plot_6 plot_11 plot_16 plot_2 plot_7 plot_12 plot_17 plot_3 plot_8 plot_13 plot_18 plot_4 plot_9 plot_14 plot_19 plot_5 plot_10 plot_15 plot_20 The values arranged in this file are based on users’ field layout. For example, if the field has 4 rows and 5 columns of plots, then the file should also have 4 rows and 5 columns. Values in the map file are plot IDs, which have to be unique. Image files GRID currently only supports images encoded in “uint8”. Other encoding may be problematic. There’s no limitation on the number of bands. 1.2 Crop Images There’re 2 magnification levels available for the mouse cursor. Users can switch the level by right-clicking on any place of the image. Left-clicking on the image to define four corners of the sub-image you want to analyze on. The fifth click will reset all the red marks 1.3 Plots extraction This is a panel to define vegetation plots (i.e., area of interest, AOI). The yellow area is the one that will be selected, whereas pixels colored as black will be excluded from the following calculation. GRID will run a K-mean clustering algorithm to extract the vegetation areas. Only bands of red and near-infrared red (NIR) will be used in K-mean clustering. Selected K will tell GRID that how many clusters are expected in the image. To assign which clusters as AOI, users can either let the program decide automatically or select them manually. "],
["load-data-2.html", "2 Load data", " 2 Load data "],
["step-by-step-tutorial.html", "3 Step by Step Tutorial 3.1 GWAS in GAPIT 3.2 K-fold cross-validation GS in BGLR 3.3 GWAS-assisted GS in rrBLUP 3.4 Convert Hapmap to PLINK format", " 3 Step by Step Tutorial This chapter we’ll demonstrate four commonly used analyses in iPat with step-by-step GIFs and brief descriptions. Readers can find all the demo files from here. 3.1 GWAS in GAPIT In this section, we’re demonstrate how users can conduct GAPIT GWAS with PLINK files. Compressed mixed linear model will be used in this study. Prepare PLINK files Fig. Check if the format is PLINK Import files Fig. Import files to iPat Define GAPIT Fig. Define GAPIT analysis Inspect results Fig. Files will be generated while iPat is running 3.2 K-fold cross-validation GS in BGLR In this study, we’re going to perform GS with 5-fold cross-validation. The input files are in VCF format. Prepare VCF files Fig. Check if the format is VCF Import files Fig. Import files to iPat Define BGLR Fig. Define validation details Inspect results Fig. Monitor the progress of validations 3.3 GWAS-assisted GS in rrBLUP In this case, we will use numerical files to demonstrate GWAS-assisted GS in iPat, with the implementation of FarmCPU and rrBLUP. Import files Fig. Import files to iPat Define FarmCPU (GWAS) Fig. Define GWAS in FarmCPU Define rrBLUP (GS) Fig. Define GS in rrBLUP Inspect Progress Fig. Monitor the progress of validations 3.4 Convert Hapmap to PLINK format This section will demonstrate that how to convert Hapmap files into PLINK-formatted files. Prepare Hapmap files Fig. Check if the format is Hapmap Import files Fig. Import Hapmap files into iPat Define BGLR Fig. Define the conversion Inspect results Fig. Inspect results "],
["formats.html", "4 Formats 4.1 Input formats 4.2 Output formats", " 4 Formats 4.1 Input formats 4.1.1 Genotype Hapmap Table 4.1: Hapmap format rs alleles chrom pos strand assembly center protLSID assayLSID SNP_1 A/C 1 1000 + AGPv1 Panzea NA NA SNP_2 C/G 1 1010 + AGPv1 Panzea NA NA SNP_3 G/T 1 1020 + AGPv1 Panzea NA NA Table 4.1: Hapmap format (Continued) panel QCcode ID_1 ID_2 ID_3 nam NA CC NA AC nam NA CC GG CC nam NA GG GG TT VCF Reference Table 4.2: VCF format CHROM POS ID REF ALT QUAL FILTER INFO 1 1000 SNP_1 A C 29 PASS NS=3;DP=14;AF=0.5;DB;H2 1 1010 SNP_2 C G 3 q10 NS=3;DP=11;AF=0.017 1 1020 SNP_3 G T 67 PASS NS=2;DP=10;AF=0.333,0.667 Table 4.2: VCF format (Continued) FORMAT ID_1 ID_2 ID_3 GT:GQ:DP:HQ 1|1:48:1:51,51 .|.:8:8:51,51 0/1:43:5:.,. GT:GQ:DP:HQ 0|0:49:3:58,50 1|1:3:5:65,3 0/0:41:3 GT:GQ:DP:HQ 0|0:21:6:23,27 0|0:2:0:18,2 1/1:35:4 Numerical Data ## Warning in kableExtra::kable_styling(., full_width = F): Please specify ## format in kable. kableExtra can customize either HTML or LaTeX outputs. See ## https://haozhu233.github.io/kableExtra/ for details. Table 4.3: Numerical format taxa SNP_1 SNP_2 SNP_3 ID_1 2 0 0 ID_2 NA 2 0 ID_3 2 0 0 PLINK Reference Missing values must be assigned as 0 Table 4.4: PLINK format ID_1 ID_1 0 0 0 0 C C C C G G ID_2 ID_2 0 0 0 0 0 0 G G G G ID_3 ID_3 0 0 0 0 A C C C T T 4.1.2 Phenotype Table 4.5: Phenotype format taxa y75 y50 y25 ID_1 -1.261850849964 -9.91585546798912 -6.36283902912281 ID_2 2.59372569418469 -6.51298727967311 2.29326112214355 ID_3 2.91265183779147 -22.1380297243291 19.6659577252647 … … … … 4.1.3 Map Table 4.6: SNPs Map for numerical formats SNP Chromosome Position SNP_1 1 1000 SNP_2 1 1010 SNP_3 1 1020 … … … Table 4.7: SNPs Map for PLINK formats 1 SNP_1 0 1000 1 SNP_2 0 1010 1 SNP_3 0 1020 … … … … 4.1.4 Covariates Table 4.8: Covariates format Taxa Cov1 Cov2 ID_1 3.617538 -0.9368706 ID_2 0.888413 -0.0546190 ID_3 -1.276830 0.2140963 4.1.5 Kinship Table 4.9: Kinship format 1.7675808170611 0.0312931060706081 0.0584911825909184 … 0.0312931060706081 1.85921066074289 0.0206883855892893 … 0.0584911825909184 0.0206883855892893 1.88643105515969 … … … … … 4.2 Output formats 4.2.1 Figures Manhattan plot Fig. Manhattan plot by GWAS Scatter plot: Q-Q plot Fig. Q-Q plot by GWAS Histogram: GEBV distribution Fig. Distribution for GEBVs Density function: Accuracies for GS validations Fig. Distribution for prediction accuracies Scatter plot: GS predictions against observations Fig. Distribution for prediction accuracies Histogram: Heterozygosity distribution Fig. Histograms for overview of heterozygosity Phenotype overview Fig. Figure for overview of phenotypes 4.2.2 Tabular results GWAS report Table 4.10: Tabular GWAS results SNP Chromosome Position P.value maf effect PZB00859.1 1 157104 0.8796673 0.2402135 0.0513818 PZA01271.1 1 1947984 0.0450554 0.4893238 0.5985480 PZA03613.2 1 2914066 0.0152657 0.2900356 0.7550551 PZA03613.1 1 2914171 0.7736487 0.2508897 -0.1049524 PZA03614.2 1 2915078 0.1072168 0.4697509 -0.4744598 GS: GEBV Table 4.11: GEBV for each individual taxa GEBV ID_1 -1.77193474724802 ID_2 1.72387204220987 ID_3 1.68334659084122 ID_4 -2.41038775121833 ID_5 -5.74618607007748 … … GS: Marker effects Table 4.12: Genetic effects for each marker V1 u M_1 -0.00567222219641276 M_2 0.0212495891997373 M_3 0.030552733100474 M_4 -0.0212824623926987 M_5 -0.0126398188395629 … … GS: Validation results Table 4.13: Accuracies from GS validation r rmse trait iter fold 0.6141 5.8551 y75 1 1 0.5466 5.0126 y75 1 2 0.6173 4.7957 y75 1 3 0.5112 5.8834 y75 1 4 0.5525 4.5914 y75 1 5 GS: Predicted values Table 4.14: List of predicted and observed phenotypes obs pre trait iter fold -1.2619 -2.8336 y75 1 1 2.5937 -0.1296 y75 1 2 -7.4122 -0.6723 y75 1 3 -4.3864 -3.1929 y75 1 4 -3.9676 -7.8634 y75 1 5 -8.4040 -2.2128 y75 2 1 -4.4187 -4.3261 y75 2 2 16.0423 1.9852 y75 2 3 "],
["get-started-1.html", "5 Get started 5.1 Windows users 5.2 Mac OS users", " 5 Get started The operation environment need to meet the following requirements: Java Runtime Environment (JRE): Version 8 or later. R: Version 3.5 or later. (It’s highly recommended to update R to the latest version for first-time users, since some packages may not be available to download in older versions of R) Install all the required R libraries by running following code. This command will download all the missing packages that are required in iPat. source(&quot;http://zzlab.net/iPat/iPat_installation.r&quot;) 5.1 Windows users Download iPat.zip and decompress it. You will then get a folder named “iPat”, which contains a executable file “iPat.exe” and a folder “res”. It’s noted that users are always required to place “iPat.exe” and the folder “res” in the same folder (directory) so that iPat can function normally. Double click ‘iPat.exe’ to launch iPat. 5.2 Mac OS users Download iPat_Installer.dmg and mount it on Mac. Follow the instruction to install iPat. Double click ‘iPat.app’ to launch iPat. "],
["interface-and-usage-1.html", "6 Interface and Usage 6.1 Workflow 6.2 Global settings 6.3 GWAS 6.4 GS 6.5 GWAS-assisted GS 6.6 Format converter 6.7 Multi-thread is supported", " 6 Interface and Usage In this chapter, we’ll walk through the basic workflow in iPat and how users can define their analyses with different tools. Also, other miscellaneous features will be addressed in the later section of this chapter. 6.1 Workflow To perform GWAS, GS, and GWAS-assisted GS in iPat, following six steps are demonstrated for users to follow: Create a new module Every single analysis is defined by a ‘module’, which can be created by double-click anywhere in the screen and opened by right-click on a gear-shaped icon which is newly created. It’s noted that there will always be an automatically created module at the very beginning when users launch iPat, so users only need to right-click on the gear-shaped icon to start their first analysis. Fig. Right click to open a module Import files Users can drag-and-drop their files to import them into iPat. Each filetype has its own slot, and each analysis have slightly different requirements for the imported files. Please follow the instruction in section 2.3, 2.4, 2.5 to learn for further information. Fig. Drag-and-drop files to import Choose an analysis Currently there’re four analyses available in iPat. Once users done importing all the required files, they can click a desired analysis to enter the next panel for further configuration. Fig. Choose an analysis for further configuration Config and run Usually there’re two parts in this panel. In the upper part, users can specify the working directory, which phenotype to be analyzed, and quality controls on genetic markers. This panel can be globally defined regardless chosen analysis (section -2.2). Whereas the sub-panel in the bottom part is tool-specific, this area allows users to define the chosen tool in details. Please read section 2.3, 2.4, 2.5 for further information. The analysis will be launched when ‘run’ button in the right-corner is clicked. Fig. Detailed configuration for the analysis Monitor progress Users can hover the pointer on the running module to monitor its progress, or to click on the module to lock the progress window, which can prevent it from disappearing when the pointer is no longer hovered on the module. Fig. Hover the pointer to monitor the progress Inspect results Once the analysis is done, a green dot will present at the upper-left corner of the module. Users can open the working directory and find all the output files by double-clicking on the module. Fig. Double click to open the working directory 6.2 Global settings 6.2.1 Working directory Users can specify the working directory and module names in this panel. Module names will be presented in the output, which can serve as a label for users to distinguish different analyses. Fig. Panel for users to define working directory 6.2.2 Phenotype Sometimes users may have several traits in one phenotype file, but not all of them are traits of interest. To deal with this concern, in this panel, traits can be selected and excluded for the following analysis. Click ‘–&gt;’ button to exclude traits that are not the interest of this analysis, or click ‘&lt;–’ button to rescue back traits that are mistakenly excluded. Fig. Panel for users to select traits of interest 6.2.3 Quality Control Two ways of quality controls (QC) are available in this panel, both ways will be applied to genetic markers. ‘By missing rate’ will filter out any marker that has missing rate (i.e., 1 - calling rate) higher than the assigned value. ‘By MAF’ will filter out markers with minor allele frequency lower than the assigned value. Fig. Sliders for performing quality controls 6.3 GWAS It’s required to provide genotype, map (if applicable), and phenotype files to run GWAS in iPat. Covariates and kinship matrix are optional. User-provided covariates will serve as fixed effects in the GWAS model. Often time users are not recommended to provide a kinship matrix, since those implemented tools will generate one automatically and user-define kinship is used only in ‘MLM’ and ‘CMLM’ from GAPIT. Output files from GWAS include: Figures: Manhattan plot, Q-Q plot, Heterozygosity distribution, and Phenotype overview Tables: GWAS report 6.3.1 GAPIT Table 6.1: Arguments for GAPIT Arguments Default Options Description Model GLM GLM, MLM, CMLM, FarmCPU Implemented models: general linear model (GLM), mixed linear model (MLM), compressed mixed linear model (CMLM), and FarmCPU. PC 3 Ranges between 3 to 10 Principal components to control spurious signals caused by population stratifications Fig. Configuration for GAPIT Reference Tang,Y. et al. (2016) GAPIT Version 2: An Enhanced Integrated Tool for Genomic Association and Prediction. Plant J., 9. 6.3.2 FarmCPU Table 6.2: Arguments for FarmCPU Arguments Default Options Description Method bin optimum static, optimum maxLoop 10 Ranges between 1 to 10 Number of iterations for FarmCPU to detect QTNs Fig. Configuration for FarmCPU Reference Liu,X. et al. (2016) Iterative Usage of Fixed and Random Effect Models for Powerful and Efficient Genome-Wide Association Studies. PLoS Genet., 12 , e1005767 6.3.3 PLINK Table 6.3: Arguments for PLINK Arguments Default Options Description C.I. 0.95 0.95, 0.975, 0.995 Confident interval for testing marker effects Method GLM GLM, Logistic Regression Implemented models Fig. Configuration for PLINK Reference Purcell,S. et al. (2007) PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses. Am J Hum Genet, 81, 559–575. 6.4 GS It’s required to provide genotype and phenotype files to run GS in iPat. User-provided covariates will serve as fixed effects in the GS model, but none of GS methods will take user-defined kinship in iPat. In iPat, users can perform two types of GS. If the ‘validation’ option is unchecked, iPat would estimate genetic estimated breeding values (GEBV) for samples in the whole dataset based on the phenotyped samples. Whereas when users check the option ‘Validation on accuracy’, iPat will split whole dataset into training and testing samples in order to verify the capability of trained GS model. For this manner, validation accuracies will be reported instead of GEBVs. Table 6.4: Arguments for GS Arguments Default Options Description Validation on accuracy unchecked checked, unchecked If k-fold validation is performed in GS Folds 3 3, 5, 10 K value for K-fold validation. For example, if k = 5, 20% samples will be tested as accuracy validation. Iteration 10 Range from 10 to 100 Number of iterations. Each iteration will split whole dataset into training part and testing part based on the specified k value for K-fold validation. Output files from GS include: Figures: GEBV distribution, Validation accuracies, Predicted versus observed values, Heterozygosity distribution, and Phenotype overview. Tables: GEBV report, Marker effects, Validation results, and Predicted values 6.4.1 gBLUP and rrBLUP There’s no specific arguments available for both of these methods. Reference Endelman,J. (2011) Ridge regression and other kernels for genomic selection in the R package rrBLUP. Plant Genome, 4, 250–255. 6.4.2 BGLR Table 6.5: Arguments for BGLR Arguments Default Options Description Model for predictors BRR BRR, Bayes A, Bayes B, Bayes C, BL Model to estimate marker effects nIter 5k Range from 1k to 100k Number of iteration burnIn 500 Range from 200 to 10k Burn-in values Reference Pérez, Paulino. et al. (2014) Genome-wide regression and prediction with the BGLR statistical package. Genetics, 198, 483-495. 6.5 GWAS-assisted GS It’s a hybrid analysis that includes GWAS reported markers as covariates (fixed effects) in the GS model, whichever tested marker that has an association signal more significant than Bonferroni cutoff (p-value &lt; 0.05 / number of markers) will be considered as such covariates. The workflow for GWAS-assisted GS in iPat is basically the same as performing GWAS and GS alone, please follow the tutorial for details. 6.6 Format converter iPat not only provides a format-free environment for genomic studies, it also allows users to utilize the build-in converter to convert files for other further purposes. By providing a genotype file and a map file (if applicable) that meet a certain format, iPat can convert them into numerical-encoded genotypes or PLINK format that is compatible to other software. Other than specifying requested formats and arguments for quality controls, users can decide whether they would like to have missing values filled as heterozygous genotypes. Also, the argument “Batch size” determines how many samples are read into the memory at a time. The larger the batch size is, the faster the conversion would be. However, for those computing units with limited memory resources, it’s highly recommended to start from a smaller number such as 64 or 32. Large batch size will crash the program easily when dealing with a large number of markers. Table 6.6: Arguments for iPat converter Arguments Default Options Input formats None Numerical, Hapmap, VCF, PLINK Output formats None Numerical, PLINK By missing rate 0.2 0, 0.05, 0.1, 0.2, 0.5 By MAF 0.05 0, 0.01, 0.05, 0.1, 0.2 Fill NA unchecked checked, unchecked Batch size 64 32, 64, 128, 256, 512 6.7 Multi-thread is supported "]
]
